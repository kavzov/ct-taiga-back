{% extends "index.html" %}

{% block content %}
    <!-- Project details -->
    <h2>
        <span{# if user permissions #} onmouseover="document.getElementById('edit-project-name-label').style.visibility='visible';" onmouseout="document.getElementById('edit-project-name-label').style.visibility='hidden';"{# endif user permissions #}>
            Project &quot;{{ project_details.name }}&quot;
            {# if user permissions #}
            &nbsp;<span id="edit-project-name-label" style="visibility:hidden; display:inline-block; font-size:.6em; font-weight:normal;">
                <a href="/issues/edit_project_name/" title="Edit project" style="text-decoration:none; color:#262;"><span style="display:inline-block; padding-bottom:0; line-height:1em; border-bottom:1px dotted #262;">Edit</span></a>
            </span>
            {# endif user permissions #}
         </span>
    </h2>
    <div>
        <p style="padding:0 1.3em;">{{ project_details.description }}</p>
    </div>
    {# if owner #}
    <!--
    div Owner: {{ owner }}
    {# if user permissions #}
    Change owner
    {# end if user permissions #}
    -->
    {# endif owner #}

    <!--
    div Members: {{ members }}
    {# if user permissions #}
    Add/delete/change role of member
    {# end if user permissions #}
    -->
    <div style="padding:.5em 1.3em .2em;">
        {% for member, member_roles in members_roles.items %}
        <p style="padding:0; margin:.2em 0;">
            <a href="/users/{{ member.user.id }}/">{{ member.user.get_full_name }}</a>:&nbsp;
            {% for member_role in member_roles %}
                {{ member_role.name }}{% if not forloop.last %},{% endif %}
            {% endfor %}
        </p>
        {% endfor %}
    </div>

    <div style="font-size:.95em; padding:.3em 1.3em; line-height:1.4em;">
    <b>Total time: </b>{{ total_time|floatformat }}<br>
    <a href="/timelogs?project_id={{ project_details.id }}" title="View the projects timelogs">Timelogs</a>&nbsp;
    <a href="/timelogs/add_timelog?project_id={{ project_details.id }}" title="Add a new timelog to the project" style="text-decoration:none; color:#262;">
        &plus;<span style="display:inline-block; padding-bottom:0; line-height:1em; border-bottom:1px dotted #262;">Add
    </a>
    </div>

    <!--
    div Timelogs: {{ timelogs }}
    {# if user permissions #}
    Add timelog
    {# end if user permissions #}
    -->


    {% if not timelogs_list %}
    <!-- Issues list at the project -->
    <h3>Issues</h3>
    <div>
        <ul style="list-style-type:none; padding:0 1em; margin:.5em; line-height:1.5em; font-size:.95em;">
        {# if user permissions #}
            <li>
                <a href="/issues/new_issue/" title="Add a new issue" style="text-decoration:none; color:#262;">
                &plus;<span style="display:inline-block; padding-bottom:0; margin-bottom:.5em; line-height:1em; border-bottom:1px dotted #262;">Add</span>
                </a>
            </li>
        {# endif user permissions #}
        {% for issue in issues %}
            <li>
                <span onmouseover="document.getElementById('edit-project-issue-{{ issue.id }}').style.visibility='visible';" onmouseout="document.getElementById('edit-project-issue-{{ issue.id }}').style.visibility='hidden';">
                    <a href="/issues/{{ issue.id }}"><b>{{ issue.subject }}</b></a>
                    {# if user permissions #}
                    <span id="edit-project-issue-{{ issue.id }}" style="font-size:.85em; visibility:hidden;">
                        &ensp;<a href="/issues/edit_project_description/" title="Edit issue" style="text-decoration:none; color:#262;"><span style="display:inline-block; padding-bottom:0; line-height:1em; border-bottom:1px dotted #262;">Edit</span></a>
                    </span>
                    {# endif user permissions #}

                    <span style="display:block; margin:.2em 0; line-height:1.3em;">{{ issue.description }}</span>
                </span>
                <span style="display:block; line-height:1.3em;"><b>Assigned to:</b> <a href="/users/{{ issue.assigned_to.id }}">{{ issue.assigned_to.get_full_name }}</a></span>
                <span style="display:block; margin:0 0 .8em; line-height:1.3em;"><b>Status:</b> {{ issue.status }}</span>
            </li>
        {% endfor %}
        </ul>
    </div>
    <!-- END Issues list at the project -->

    {% endif %}{# not timelogs_list #}
    <!-- END Edit the project -->

    {% if timelogs_list %}
    <h3>Timelogs</h3>
    {% include "timelogs/timelogs_table.html" %}
    {% endif %}

{% endblock content %}
